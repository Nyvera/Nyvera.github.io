<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PrisimAI â€” Chat with AI</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  /* same glassmorphism styles as before */
  body{
    margin:0;font-family:Inter,system-ui;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(80,120,255,0.12), transparent 8%),
                radial-gradient(1000px 500px at 90% 85%, rgba(200,100,255,0.08), transparent 10%),
                #0f1724;
    height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;
    color:#fff;
  }
  .app{width:100%;max-width:800px;height:90vh;display:flex;flex-direction:column;
    backdrop-filter:blur(12px) saturate(120%);background:rgba(255,255,255,0.06);
    border:1px solid rgba(255,255,255,0.12);border-radius:16px;overflow:hidden;}
  header{padding:16px;border-bottom:1px solid rgba(255,255,255,0.1);font-weight:600;font-size:20px}
  .chat{flex:1;overflow:auto;padding:16px;display:flex;flex-direction:column;gap:12px}
  .msg{max-width:75%;padding:12px 14px;border-radius:12px;line-height:1.45;font-size:14px}
  .user{align-self:flex-end;background:rgba(255,255,255,0.1)}
  .ai{align-self:flex-start;background:rgba(255,255,255,0.05)}
  .composer{display:flex;padding:12px;border-top:1px solid rgba(255,255,255,0.1)}
  textarea{flex:1;resize:none;border:0;background:transparent;color:#fff;outline:none;font-size:15px}
  button{background:rgba(255,255,255,0.1);border:0;border-radius:10px;padding:10px 16px;
    margin-left:8px;color:#fff;font-weight:600;cursor:pointer}
</style>
</head>
<body>
<div class="app">
  <header>ðŸ’Ž PrisimAI</header>
  <div class="chat" id="chat"></div>
  <div class="composer">
    <textarea id="input" placeholder="Type a message..."></textarea>
    <button id="sendBtn">Send</button>
  </div>
</div>

<script>
const API_URL = "https://api.mistral.ai/v1/agents/invoke";
const API_KEY = "Uhk3m4xQ1m3MeyJD8G2hUXV9CUPia9AE";
const AGENT_ID = "ag:00a239e3:20250918:prisimai:1e918d1e";

const chat = document.getElementById('chat');
const input = document.getElementById('input');
const sendBtn = document.getElementById('sendBtn');

function addMessage(role, text){
  const div = document.createElement('div');
  div.className = 'msg ' + (role === 'user' ? 'user' : 'ai');
  div.innerHTML = text.replace(/\n/g,'<br>');
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

async function sendMessage(text){
  addMessage('user', text);
  input.value = "";

  try{
    const res = await fetch(API_URL, {
      method: "POST",
      headers: {
        "Authorization": "Bearer " + API_KEY,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        agent_id: AGENT_ID,
        input: text
      })
    });

    if(!res.ok){
      const errText = await res.text();
      addMessage('ai', "Error: " + res.status + " " + errText);
      return;
    }

    const data = await res.json();
    // Mistral returns something like { output: "..." }
    const reply = data.output || JSON.stringify(data);
    addMessage('ai', reply);
  }catch(err){
    addMessage('ai', "Error: " + err);
  }
}

sendBtn.addEventListener('click', ()=>{
  const txt = input.value.trim();
  if(txt) sendMessage(txt);
});
input.addEventListener('keydown', (e)=>{
  if(e.key === "Enter" && !e.shiftKey){
    e.preventDefault();
    sendBtn.click();
  }
});
</script>
</body>
</html>
